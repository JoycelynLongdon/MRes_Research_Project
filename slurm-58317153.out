cpu-bind=MASK - gpuhost591, task  0  0 [125455]: mask 0x2 set
cpu-bind=MASK - gpuhost591, task  0  0 [125914]: mask 0x2 set
(1483, 2353, 7)
(1483, 2353)
We have 1322596 samples
The training data include 8 classes: [1 2 3 4 5 6 7 8]
Our X matrix is sized: (1322596, 7)
Our y array is sized: (1322596,)
TRAIN: [  18595   18596   18597 ... 1322593 1322594 1322595] TEST: [     0      1      2 ... 206111 206112 206641]
TRAIN: [      0       1       2 ... 1322593 1322594 1322595] TEST: [ 18595  18596  18597 ... 379338 379339 379340]
TRAIN: [      0       1       2 ... 1322593 1322594 1322595] TEST: [ 27554  27555  27556 ... 545198 545199 545200]
TRAIN: [      0       1       2 ... 1322593 1322594 1322595] TEST: [ 32127  32128  32129 ... 678038 678039 678040]
TRAIN: [      0       1       2 ... 1322593 1322594 1322595] TEST: [ 36431  36432  36433 ... 789466 789467 789468]
TRAIN: [      0       1       2 ... 1322593 1322594 1322595] TEST: [ 48237  48238  48239 ... 903431 903432 903441]
TRAIN: [      0       1       2 ... 1322593 1322594 1322595] TEST: [  50207   50208   50209 ... 1011197 1011198 1011199]
TRAIN: [      0       1       2 ... 1322593 1322594 1322595] TEST: [  53003   53004   53005 ... 1118295 1118296 1118297]
TRAIN: [      0       1       2 ... 1322593 1322594 1322595] TEST: [  56409   56410   56413 ... 1221743 1221744 1221745]
TRAIN: [      0       1       2 ... 1221743 1221744 1221745] TEST: [ 447761  447762  447766 ... 1322593 1322594 1322595]
(1190337, 7)
(132259, 7)
(1190337,)
(132259,)
Our OOB prediction of our baseline model accuracy is: 80.15822409956172%
predict      1      2     3       4       5      6     7     8      All
truth                                                                  
1        59437      0     0    5410    6061     25    38     0    70971
2           56  15531     0     691    2606     52     0     0    18936
3            7      0  3727     402     175      5     0     0     4316
4          280      0     0  926859   15230    535    91     0   942995
5          625      5     4   19372  204785    168   370    10   225339
6          252      0     3    1574    8061  39072   239     4    49205
7          213      8     0      66     160      8  3575     5     4035
8            7      0     0     141    1848     26     7  4770     6799
All      60877  15544  3734  954515  238926  39891  4320  4789  1322596
                   precision    recall  f1-score   support

         Cropland       0.25      0.07      0.11      7098
  Mosaic Cropland       0.00      0.00      0.00      1894
Mosaic Vegetation       0.00      0.00      0.00       431
           Forest       0.76      0.95      0.85     94300
        Shrubland       0.18      0.09      0.12     22533
        Grassland       0.39      0.11      0.17      4920
            Urban       0.01      0.01      0.01       404
            Water       0.91      0.30      0.45       679

         accuracy                           0.70    132259
        macro avg       0.31      0.19      0.21    132259
     weighted avg       0.61      0.70      0.64    132259

Confusion matrix:
[[  491     0     0  5410  1134    25    38     0]
 [   56     0     0   691  1095    52     0     0]
 [    7     0     0   402    17     5     0     0]
 [  280     0     0 89447  3947   535    91     0]
 [  625     5     4 19372  1979   168   370    10]
 [  252     0     3  1574  2320   528   239     4]
 [  213     8     0    66   100     8     4     5]
 [    7     0     0   141   294    26     7   204]]
Band 1 importance: 0.12407676642074758
Band 2 importance: 0.1401334871824776
Band 3 importance: 0.11468936073320865
Band 4 importance: 0.1401322412279444
Band 5 importance: 0.13325047478755978
Band 6 importance: 0.18295891418368643
Band 7 importance: 0.16475875546437552
Parameters currently in use:

{'bootstrap': True,
 'ccp_alpha': 0.0,
 'class_weight': None,
 'criterion': 'gini',
 'max_depth': None,
 'max_features': 'auto',
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_impurity_split': None,
 'min_samples_leaf': 1,
 'min_samples_split': 2,
 'min_weight_fraction_leaf': 0.0,
 'n_estimators': 500,
 'n_jobs': None,
 'oob_score': True,
 'random_state': None,
 'verbose': 0,
 'warm_start': False}
Fitting 3 folds for each of 1 candidates, totalling 3 fits
[CV] END bootstrap=True, max_depth=20, min_samples_leaf=1, min_samples_split=2, n_estimators=500; total time=23.2min
[CV] END bootstrap=True, max_depth=20, min_samples_leaf=1, min_samples_split=2, n_estimators=500; total time=22.8min
[CV] END bootstrap=True, max_depth=20, min_samples_leaf=1, min_samples_split=2, n_estimators=500; total time=21.8min
Random Forest Train Accuracy Baseline After Grid Search: 0.8925010312205703
Random Forest Test Accuracy Baseline After Grid Search: 0.7022433255959897
[[  438     0     0  5512  1096    18    34     0]
 [   51     0     0   668  1124    51     0     0]
 [    7     0     0   403    17     4     0     0]
 [  244     0     0 89863  3651   461    81     0]
 [  665     2     3 19463  1883   169   342     6]
 [  221     0     2  1620  2365   483   227     2]
 [  237     3     0    50    96     8     6     4]
 [    7     0     0   137   297    26     7   205]]
              precision    recall  f1-score   support

           1       0.23      0.06      0.10      7098
           2       0.00      0.00      0.00      1894
           3       0.00      0.00      0.00       431
           4       0.76      0.95      0.85     94300
           5       0.18      0.08      0.11     22533
           6       0.40      0.10      0.16      4920
           7       0.01      0.01      0.01       404
           8       0.94      0.30      0.46       679

    accuracy                           0.70    132259
   macro avg       0.32      0.19      0.21    132259
weighted avg       0.61      0.70      0.64    132259

Traceback (most recent call last):
  File "/gws/nopw/j04/ai4er/users/jl2182/MRes_Research_Project/src_experiments/landcover_classification/rf_landcover_classification.py", line 206, in <module>
    hyper_param_rf_predict(X_train, y_train, X_test, y_test)
  File "/gws/nopw/j04/ai4er/users/jl2182/MRes_Research_Project/src_experiments/landcover_classification/rf_landcover_classification.py", line 194, in hyper_param_rf_predict
    conf_mat = confusion_matrix(y_test,y_pred)
NameError: name 'y_pred' is not defined
srun: error: gpuhost591: task 0: Exited with exit code 1
